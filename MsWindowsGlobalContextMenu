==== Starting Emacs From Global Context Menu ====
Here is a simple but useful way to access Emacs.  It adds
the option to open a file in Emacs to your global context menu
(i.e., right clicking on a file).  It will connect to a running Emacs server if one exists. 
Be sure to change the path to the location of your Emacs binary.

<pre>
Windows Registry Editor Version 5.00
;; Be sure to set the correct path to Emacs on your system!
[HKEY_CURRENT_USER\*\shell]

;; Open file in existing frame
[HKEY_CURRENT_USER\*\shell\emacsopencurrentframe]
@="&Emacs: Edit in existing window"
"icon"="C:\\path\\to\\emacs\\bin\\emacsclientw.exe"
[HKEY_CURRENT_USER\*\shell\emacsopencurrentframe\command]
@="C:\\path\\to\\emacs\\bin\\emacsclientw.exe -n --alternate-editor=\"C:\\path\\to\\emacs\\bin\\emacsclient.exe\" \"%1\""

;; Open file in new frame
[HKEY_CURRENT_USER\*\shell\emacsopennewframe]
@="&Emacs: Edit in new window"
"icon"="C:\\path\\to\\emacs\\bin\\emacsclientw.exe"
[HKEY_CURRENT_USER\*\shell\emacsopennewframe\command]
@="C:\\path\\to\\emacs\\bin\\emacsclientw.exe -n --alternate-editor=\"C:\\path\\to\\emacs\\bin\\emacsclient.exe\" -c \"%1\""

;; Dired support
[HKEY_CURRENT_USER\Directory\shell\emacsopensameframe]
@="&Emacs: Open in dired"
"icon"="C:\\path\\to\\emacs\\bin\\emacsclientw.exe"
[HKEY_CURRENT_USER\Directory\shell\emacsopensameframe\command]
@="C:\\path\\to\\emacs\\bin\\emacsclientw.exe  -n --alternate-editor=\"C:\\path\\to\\emacs\\bin\\emacsclient.exe\" \"%1\""
</pre>


Emacsclient may stop functioning if there is an old server file left over from previous instance of Emacs which has not shut down properly. To fix this you can clear the server files: 

 rm "~\.emacs.d\server\*"

Note that HKEY_CLASSES_ROOT is a thing of the past. Please use HKEY_CURRENT_USER\Software\Classes instead.
