This page is about different ways to integrate Emacs into MS Windows:

== Run Emacs from a `cmd' Window ==

Put the Emacs `bin' folder in the Windows ##PATH## environment variable (right-click Computer, Properties, Advanced, Environment Variables).  This also simplifies other methods mentioned on this page (no explicit paths needed then).

== Desktop or start menu shortcut ==

Use this code for a desktop/task-bar shortcut. Right-click in a file folder, select New -> Shortcut, and enter: 

{{{
c:\path\to\emacs\bin\emacsclientw.exe -c -n -a c:\path\to\emacs\bin\runemacs.exe
}}}

This shortcut will connect to [WThirtyTwoServerMode Emacs daemon] if it is running, otherwise opens a new frame.

  -c tells emacs to create a new frame instead of trying to use an existing frame.
  -n means no wait - don't wait for the server to return
  -a EDITOR specifies to the emacsclientw.exe which editor to run if emacs.exe is not running. An empty string starts a new server if needed

== Right-Click Context Menu == 
There are several options for adding an "Open in Emacs" command that can be found here: MsWindowsGlobalContextMenu

== Create File Associations ==

To open text files with the emacs daemon, run cmd.exe as administrator use the commands and `ftype' and `assoc':

    ftype txtfile=emacsclientw -na runemacs "%1"
    ftype EmacsLisp=emacsclientw -na runemacs "%1"
    ftype CodeFile=emacsclientw -na runemacs "%1"
    assoc .txt=txtfile
    assoc .text=txtfile
    assoc .log=txtfile
    assoc .org=txtfile
    assoc .el=EmacsLisp
    assoc .c=CodeFile
    assoc .h=CodeFile

== Set `emacsclient' as Your Editor ==

This almost works:
{{{
  git config --global core.editor "emacsclient -a emacs '%*'"
}}}

Do ''not'' use ##emacsclientw## here; it doesn't wait.

== Replace `notepad.exe` calls ==

A quick and dirty way to replace all ##notepad.exe## calls from any application (and your file manager) would be to use the Registry:

1. Start ##regedit.exe##

2. Go to ##HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion?\Image File Execution Options##

3. Add a new key named ##notepad.exe##

4. Add (in there) a new string named ##Debugger## and use this value: ##emacsclientw.exe -na runemacs.exe -F## (requires ##emacsclientw## to be in your ##PATH##)

Note that this will pretty much break the usual ##-F## behavior but it is needed as ##emacsclientw## has no [http://stackoverflow.com/questions/2984846/set-image-file-execution-options-will-always-open-the-named-exe-file-as-defaul -z parameter] (yet).


== Workaround to get`term`/`ansi-term` working with `cmd.exe` or Cygwin bash

Check out [https://github.com/d5884/fakecygpty]. This is your best bet to get `term`/`ansi-term` working with a proper shell on Windows with Win32 Emacs.

You will need Cygwin installed to build it.


= Run Emacs server at windows startup & create shortcut to Emacs client =

Tested on Windows 10. In your Emacs/bin directory (where your Emacs binaries are) create a shortcut to ##runemacs.exe##. You may right-click on file ##runemacs.exe## and choose ##send-to desktop (create shortcut)##.

Right click on newly created shortcut and choose ##Properties##. 
In ##Target## put following: ##"X:\path\to\emacs\bin\runemacs.exe" --daemon## , X:\path\to\emacs is your drive letter and path where emacs resides on your harddrive. Close the properties dialog. 

Press ##Win+r## to open Run dialog and type ##shell:startup##.

Copy your newly created link to Emacs server into opened directory. Emacs will start up automatically next time you start the system. Double click on the shortcut to start Emacs server now if it is not already running.

In your Emacs/bin directory, create a new shortcut file to ##emacsclientw.exe##.
Open Properties for newly created shortcut and in ##Target## type: 
##X:\path\to\emacs\bin\emacsclientw.exe -na "X:\path\to\emacs\bin\runemacs.exe" -c -n##
In ##Open in## field, type ##%Documents%## or whatever your choice for default directory is.
Close the ##Properties## dialog and rename your shortcut to just: ##emacs##
Drag your newly created shortcut to your startbar, or desktop or wherever you wish to have it.

OBS: No need to edit your .emacs file and add server line to it.



== Debug Version ==
Sometimes it is useful to be able to start up default autonomous copy of Emacs (not client/server), for example if you play with your config file and something gets messed up.

Create a new shortcut to "emacs.exe".
Right click newly created shortcut and choose properties.
In ##target## field type: ##"X:\path\to\emacs\bin\emacs.exe" --debug-init##
Close properties dialog.

----

CategoryWThirtyTwo
